{
  "hash": "e79e1fa9b8729e0791926e16c5f74e4a",
  "result": {
    "markdown": "---\nexecute:\n  eval: false\n---\n\n::: {.cell}\n\n```{.r .cell-code}\nsource(here::here(\"setup.R\"))\n\nannual_hi_gross_tours <- \n  ind_html[[9]] |>\n  clean_names()\n\ncombine_data <- function(ind_html_list) {\n  # Initialize an empty tibble\n  combined_data <- tibble()\n  \n  # Loop through the ind_html_list and append each element to the combined_data\n  for (i in 4:8) {\n    extracted_data <- ind_html_list[[i]] |> clean_names()\n    combined_data <- bind_rows(combined_data, extracted_data)\n  }\n  \n  return(combined_data)\n}\n\nannual_hi_gross_tours <- combine_data(ind_html)\n\ntours_by_decade <-\n  annual_hi_gross_tours |>\n  dplyr::mutate(across(\n    c(adjusted_gross_in_2022_dollar,\n      averagegross,\n      actual_gross),\n    ~ as.numeric(str_replace_all(.x, \"[$,]\", \"\"))\n  )) |>\n  mutate(\n    start_year = str_sub(year_s, start = 1, end = 4),\n    year = lubridate::ymd(start_year, truncated = 2L)\n  ) |>\n  mutate(\n    decade = paste0(str_sub(\n      as.factor(floor_date(year, years(10))), start = 1, end = 4), \"s\"),\n    tour_title = case_when(tour_title == \"The Eras Tour †\" ~ \"The Eras Tour\",\n                           tour_title == \"Music of the Spheres World Tour †\" ~ \"Music of the Spheres World Tour\",\n                           tour_title == \"After Hours til Dawn Tour †\" ~ \"After Hours til Dawn Tour\",\n                           tour_title == \"Summer Carnival †\" ~ \"Summer Carnival\",\n                           tour_title == \"Global Stadium Tour\" ~ \"Global Stadium\",\n                           .default = tour_title),\n    adjusted_gross_in_2022_dollar = case_when(artist == \"Taylor Swift\" & tour_title == \"The Eras Tour\" ~ 2400000000,\n                                              .default = adjusted_gross_in_2022_dollar),\n    title = paste0(artist, \" - \", tour_title))\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ntours_1980s <-\n  tours_by_decade |> \n  filter(decade == \"1980s\") |> \n  mutate(image = case_when(title == \"Bruce Springsteen and the E Street Band - Born in the U.S.A. Tour\" ~ \"~/R/taylor-swift-tour/notebooks/tours-images/1980s/bruce.jpg\",\n                           title == \"David Bowie - Glass Spider Tour\" ~ \"~/R/taylor-swift-tour/notebooks/tours-images/1980s/bowie.jpg\",\n                           title == \"Genesis - Invisible Touch Tour\" ~ \"~/R/taylor-swift-tour/notebooks/tours-images/1980s/genesis.jpg\",\n                           title == \"Michael Jackson - Bad\" ~ \"~/R/taylor-swift-tour/notebooks/tours-images/1980s/michael.jpg\",\n                           title == \"Pink Floyd - A Momentary Lapse of Reason Tour\" ~ \"~/R/taylor-swift-tour/notebooks/tours-images/1980s/pf.jpg\",\n                           title == \"The Rolling Stones - The Rolling Stones American Tour 1981\" ~ \"~/R/taylor-swift-tour/notebooks/tours-images/1980s/stones_steel.jpg\",\n                           title == \"The Rolling Stones - Steel Wheels Tour\" ~ \"~/R/taylor-swift-tour/notebooks/tours-images/1980s/stones_america.jpg\",\n                           title == \"The Jacksons - Victory Tour\" ~ \"~/R/taylor-swift-tour/notebooks/tours-images/1980s/jacksons.jpg\",\n                           title == \"Tina Turner - Break Every Rule World Tour\" ~ \"~/R/taylor-swift-tour/notebooks/tours-images/1980s/tina.jpg\",\n                           title == \"U2 - The Joshua Tree Tour\" ~ \"~/R/taylor-swift-tour/notebooks/tours-images/1980s/u2.jpg\"))\n\ntours_1980s |> \n  ggplot(\n       aes(\n         x = fct_reorder(title, adjusted_gross_in_2022_dollar),\n         y = adjusted_gross_in_2022_dollar,\n       )) +\n  geom_col_pattern(\n    aes(pattern_filename = fct_reorder(image, rank)),\n    pattern = \"image\",\n    alpha = 0.8,\n    pattern_type = \"expand\"\n  ) +\n  scale_pattern_filename_discrete(\n    choices = tours_1980s$image\n    ) +\n  scale_x_discrete(\n    labels = function(x)\n      str_wrap(x, width = 10)\n  ) +\n  labs(title = \"Top 10 highest-grossing tours of the 2020s\") +\n  theme_minimal() +\n  theme(axis.title.x = element_blank(),\n        axis.title.y = element_blank(),\n        axis.text.x = element_blank(), \n        legend.position = \"none\",\n        title = element_text(size = 16,\n                         family = \"abril-fatface\",\n                         hjust = 0.5,\n                         color = \"#1D1E3C\"),\n        plot.margin = unit(c(0.5, 0.5, 0.5, 0.5), \n                                \"inches\")) +\n  coord_flip() +\n  geom_text(aes(label = paste0(round(adjusted_gross_in_2022_dollar/1e6, 0), \"M\"),\n            hjust = -0.1)) +\n  ylim(0, 2600000000) -> bar_1980s\n\nsave(bar_1980s, file = \"images/highest-grossing-tour-bar-1980s.rdata\")\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ntours_1990s <-\n  tours_by_decade |> \n  filter(decade == \"1990s\") |> \n  mutate(image = case_when(artist == \"Celine Dion\" ~ \"~/R/taylor-swift-tour/notebooks/tours-images/1990s/02dion.jpg\",\n                           artist == \"Eagles\" ~ \"~/R/taylor-swift-tour/notebooks/tours-images/1990s/04eagles.jpg\",\n                           artist == \"Garth Brooks\" ~ \"~/R/taylor-swift-tour/notebooks/tours-images/1990s/01brooks.jpg\",\n                           artist == \"Michael Jackson\" ~ \"~/R/taylor-swift-tour/notebooks/tours-images/1990s/05michael.jpg\",\n                           artist == \"Pink Floyd\" ~ \"~/R/taylor-swift-tour/notebooks/tours-images/1990s/09pf.jpg\",\n                           artist == \"The Rolling Stones\" & tour_title == \"Bridges to Babylon Tour\" ~ \"~/R/taylor-swift-tour/notebooks/tours-images/1990s/08stones_babylon.jpg\",\n                           artist == \"The Rolling Stones\" & tour_title == \"Voodoo Lounge Tour\" ~ \"~/R/taylor-swift-tour/notebooks/tours-images/1990s/10stones_voodoo.jpg\",\n                           artist == \"Tina Turner\" ~ \"~/R/taylor-swift-tour/notebooks/tours-images/1990s/03tina.jpg\",\n                           artist == \"U2\" & tour_title == \"PopMart Tour\" ~ \"~/R/taylor-swift-tour/notebooks/tours-images/1990s/07u2_pop.jpg\",\n                           artist == \"U2\" & tour_title == \"Zoo TV Tour\" ~ \"~/R/taylor-swift-tour/notebooks/tours-images/1990s/06u2_zoo.jpg\"))\n\ntours_1990s |> \n  ggplot(\n       aes(\n         x = fct_reorder(title, adjusted_gross_in_2022_dollar),\n         y = adjusted_gross_in_2022_dollar,\n       )) +\n  geom_col_pattern(\n    aes(pattern_filename = fct_reorder(image, rank)),\n    pattern = \"image\",\n    alpha = 0.8,\n    pattern_type = \"expand\"\n  ) +\n  scale_pattern_filename_discrete(\n    choices = tours_1990s$image\n    ) +\n  scale_x_discrete(\n    labels = function(x)\n      str_wrap(x, width = 20)\n  ) +\n  labs(title = \"Top 10 highest-grossing tours of the 1990s\") +\n  theme_minimal() +\n  theme(axis.title.x = element_blank(),\n        axis.title.y = element_blank(),\n        axis.text.x = element_blank(), \n        legend.position = \"none\",\n        title = element_text(size = 16,\n                         family = \"abril-fatface\",\n                         hjust = 0.5,\n                         color = \"#1D1E3C\"),\n        plot.margin = unit(c(0, 0, 0, 0.15), \"inches\")) +\n  coord_flip() +\n  geom_text(aes(label = paste0(round(adjusted_gross_in_2022_dollar/1e6, 0), \"M\"),\n            hjust = -0.1)) +\n  ylim(0, 2600000000) -> bar_1990s\n\nsave(bar_1990s, file = \"images/highest-grossing-tour-bar-1990s.rdata\")\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ntours_2000s <-\n  tours_by_decade |> \n  filter(decade == \"2000s\") |> \n  mutate(image = case_when(title == \"The Rolling Stones - A Bigger Bang Tour\" ~ \"~/R/taylor-swift-tour/notebooks/tours-images/2000s/stones_bang.jpg\",\n                           title == \"Madonna - Sticky & Sweet Tour\" ~ \"~/R/taylor-swift-tour/notebooks/tours-images/2000s/madonna.jpg\",\n                           title == \"U2 - Vertigo Tour\" ~ \"~/R/taylor-swift-tour/notebooks/tours-images/2000s/u2_vertigo.jpg\",\n                           title == \"The Police - The Police Reunion Tour\" ~ \"~/R/taylor-swift-tour/notebooks/tours-images/2000s/police.jpg\",\n                           title == \"U2 - U2 360° Tour\" ~ \"~/R/taylor-swift-tour/notebooks/tours-images/2000s/u2_360.jpg\",\n                           title == \"The Rolling Stones - Licks Tour\" ~ \"~/R/taylor-swift-tour/notebooks/tours-images/2000s/stones_lick.jpg\",\n                           title == \"Celine Dion - Taking Chances World Tour\" ~ \"~/R/taylor-swift-tour/notebooks/tours-images/2000s/dion.jpg\",\n                           title == \"Cher - Living Proof: The Farewell Tour\" ~ \"~/R/taylor-swift-tour/notebooks/tours-images/2000s/cher.jpg\",\n                           title == \"AC/DC - Black Ice World Tour\" ~ \"~/R/taylor-swift-tour/notebooks/tours-images/2000s/acdc.jpg\",\n                           title == \"Bruce Springsteen and the E Street Band - Magic Tour\" ~ \"~/R/taylor-swift-tour/notebooks/tours-images/2000s/bruce.jpg\"))\n\ntours_2000s |> \n  ggplot(\n       aes(\n         x = fct_reorder(title, adjusted_gross_in_2022_dollar),\n         y = adjusted_gross_in_2022_dollar,\n       )) +\n  geom_col_pattern(\n    aes(pattern_filename = fct_reorder(image, rank)),\n    pattern = \"image\",\n    alpha = 0.8,\n    pattern_type = \"expand\"\n  ) +\n  scale_pattern_filename_discrete(\n    choices = tours_2000s$image\n    ) +\n  scale_x_discrete(\n    labels = function(x)\n      str_wrap(x, width = 20)\n  ) +\n  labs(title = \"Top 10 highest-grossing tours of the 2000s\") +\n  theme_minimal() +\n  theme(axis.title.x = element_blank(),\n        axis.title.y = element_blank(),\n        axis.text.x = element_blank(), \n        legend.position = \"none\",\n        title = element_text(size = 16,\n                         family = \"abril-fatface\",\n                         hjust = 0.5,\n                         color = \"#1D1E3C\"),\n        plot.margin = unit(c(0, 0, 0, 0.15), \"inches\")) +\n  coord_flip() +\n  geom_text(aes(label = paste0(round(adjusted_gross_in_2022_dollar/1e6, 0), \"M\"),\n            hjust = -0.1)) +\n  ylim(0, 2600000000) -> bar_2000s\n\nsave(bar_2000s, file = \"images/highest-grossing-tour-bar-2000s.rdata\")\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ntours_2010s <-\n  tours_by_decade |> \n  filter(decade == \"2010s\") |> \n  mutate(image = case_when(title == \"Bruno Mars - 24K Magic World Tour\" ~ \"~/R/taylor-swift-tour/notebooks/tours-images/2010s/bruno.jpg\",\n                           title == \"Coldplay - A Head Full of Dreams Tour\" ~ \"~/R/taylor-swift-tour/notebooks/tours-images/2010s/coldplay.jpg\",\n                           title == \"The Rolling Stones - No Filter Tour\" ~ \"~/R/taylor-swift-tour/notebooks/tours-images/2010s/stones.jpg\",\n                           title == \"Ed Sheeran - ÷ Tour\" ~ \"~/R/taylor-swift-tour/notebooks/tours-images/2010s/ed.jpg\",\n                           title == \"Guns N' Roses - Not in This Lifetime... Tour\" ~ \"~/R/taylor-swift-tour/notebooks/tours-images/2010s/gnr.jpg\",\n                           title == \"Metallica - WorldWired Tour\" ~ \"~/R/taylor-swift-tour/notebooks/tours-images/2010s/metallica.jpg\",\n                           title == \"Pink - Beautiful Trauma World Tour\" ~ \"~/R/taylor-swift-tour/notebooks/tours-images/2010s/pink.jpg\",\n                           title == \"Roger Waters - The Wall\" ~ \"~/R/taylor-swift-tour/notebooks/tours-images/2010s/waters.jpg\",\n                           title == \"U2 - The Joshua Tree Tours 2017 and 2019\" ~ \"~/R/taylor-swift-tour/notebooks/tours-images/2010s/u2_josh.jpg\",\n                           title == \"U2 - U2 360° Tour\" ~ \"~/R/taylor-swift-tour/notebooks/tours-images/2010s/u2_360.jpg\"))\n\ntours_2010s |> \n  ggplot(\n       aes(\n         x = fct_reorder(title, adjusted_gross_in_2022_dollar),\n         y = adjusted_gross_in_2022_dollar,\n       )) +\n  geom_col_pattern(\n    aes(pattern_filename = fct_reorder(image, rank)),\n    pattern = \"image\",\n    alpha = 0.8,\n    pattern_type = \"expand\"\n  ) +\n  scale_pattern_filename_discrete(\n    choices = tours_2010s$image\n    ) +\n  scale_x_discrete(\n    labels = function(x)\n      str_wrap(x, width = 20)\n  ) +\n  labs(title = \"Top 10 highest-grossing tours of the 2010s\") +\n  theme_minimal() +\n  theme(axis.title.x = element_blank(),\n        axis.title.y = element_blank(),\n        axis.text.x = element_blank(), \n        legend.position = \"none\",\n        title = element_text(size = 16,\n                         family = \"abril-fatface\",\n                         hjust = 0.5,\n                         color = \"#1D1E3C\"),\n         plot.margin = unit(c(0, 0, 0, 0.15), \"inches\")) +\n  coord_flip() +\n  geom_text(aes(label = paste0(round(adjusted_gross_in_2022_dollar/1e6, 0), \"M\"),\n            hjust = -0.1)) +\n  ylim(0, 2600000000) -> bar_2010s\n\nsave(bar_2010s, file = \"images/highest-grossing-tour-bar-2010s.rdata\")\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ntours_2020s <-\n  tours_by_decade |> \n  filter(decade == \"2020s\") |> \n  mutate(image = case_when(artist == \"Beyoncé\" ~ \"~/R/taylor-swift-tour/notebooks/tours-images/beyonce2.jpg\",\n                           artist == \"Harry Styles\" ~ \"~/R/taylor-swift-tour/notebooks/tours-images/harry2.jpg\",\n                           artist == \"Coldplay\" ~ \"~/R/taylor-swift-tour/notebooks/tours-images/coldplay.jpg\",\n                           artist == \"Ed Sheeran\" ~ \"~/R/taylor-swift-tour/notebooks/tours-images/ed2.jpg\",\n                           artist == \"Elton John\" ~ \"~/R/taylor-swift-tour/notebooks/tours-images/elton2.jpg\",\n                           artist == \"Bad Bunny\" ~ \"~/R/taylor-swift-tour/notebooks/tours-images/bunny2.jpg\",\n                           artist == \"Pink\" ~ \"~/R/taylor-swift-tour/notebooks/tours-images/pink2.jpg\",\n                           artist == \"Red Hot Chili Peppers\" ~ \"~/R/taylor-swift-tour/notebooks/tours-images/rhcp.jpg\",\n                           artist == \"The Weeknd\" ~ \"~/R/taylor-swift-tour/notebooks/tours-images/wknd.jpg\",\n                           artist == \"Taylor Swift\" ~ \"~/R/taylor-swift-tour/notebooks/tours-images/taylor2.jpg\"))\n\ntours_2020s$artist <- factor(tours_2020s$artist, levels = c(\"Red Hot Chili Peppers\", \"Pink\", \"The Weeknd\", \"Bad Bunny\", \"Ed Sheeran\", \"Elton John\", \"Beyoncé\", \"Harry Styles\", \"Coldplay\", \"Taylor Swift\"))\n\ntours_2020s |> \n  ggplot(\n       aes(\n         x = fct_reorder(title, adjusted_gross_in_2022_dollar),\n         y = adjusted_gross_in_2022_dollar,\n       )) +\n  geom_col_pattern(\n    aes(pattern_filename = fct_reorder(image, -adjusted_gross_in_2022_dollar)),\n    pattern = \"image\",\n    alpha = 0.8,\n    pattern_type = \"expand\"\n  ) +\n  scale_pattern_filename_discrete(\n    choices = tours_2020s$image\n    ) +\n  scale_x_discrete(\n    labels = function(x)\n      str_wrap(x, width = 20)\n  ) +\n  labs(title = \"Top 10 highest-grossing tours of the 2020s\") +\n  theme_minimal() +\n  theme(axis.title.x = element_blank(),\n        axis.title.y = element_blank(),\n        axis.text.x = element_blank(), \n        legend.position = \"none\",\n        title = element_text(size = 16,\n                         family = \"abril-fatface\",\n                         hjust = 0.5,\n                         color = \"#1D1E3C\"),\n         plot.margin = unit(c(0, 0, 0, 0.15), \"inches\")) +\n  coord_flip() +\n  geom_text(aes(label = paste0(round(adjusted_gross_in_2022_dollar/1e6, 0), \"M\"),\n            hjust = -0.1)) +\n  ylim(0, 2600000000) -> bar_2020s\n\nsave(bar_2020s, file = \"images/highest-grossing-tour-bar-2020s.rdata\")\n```\n:::",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}