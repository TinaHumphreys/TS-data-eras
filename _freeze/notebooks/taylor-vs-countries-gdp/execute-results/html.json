{
  "hash": "652ed775d8be18ed2e50f4d1f04ac450",
  "result": {
    "engine": "knitr",
    "markdown": "::: {.cell}\n\n```{.r .cell-code}\n# To clean data\nlibrary(tidyverse)\nlibrary(janitor)\n\n# To scrape data\nlibrary(rvest)\nlibrary(httr)\nlibrary(polite)\n\n# To visualize data\nlibrary(ggplot2)\nlibrary(showtext)\nlibrary(cowplot)\n\nfont_add_google(\"Abril Fatface\", \"abril-fatface\")\nfont_add_google(\"Lato\", \"lato\")\n\nshowtext::showtext_auto()\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nurl_gdp <-\n  \"https://en.wikipedia.org/wiki/List_of_countries_by_GDP_(nominal)\"\n\nurl_gdp_bow <- polite::bow(url_gdp)\nurl_gdp_bow\n\ngdp_html <-\n  polite::scrape(url_gdp_bow) |>\n  rvest::html_nodes(\"table.wikitable\") |>\n  rvest::html_table(fill = TRUE) \n\ngdp_tab <- \n  gdp_html[[1]] |> \n  janitor::clean_names() |> \n  slice(-1) |> \n  dplyr::mutate(across(\n    c(imf_1_13,\n      world_bank_14,\n      united_nations_15),\n    ~ as.numeric(str_replace_all(.x, \"[$,]\", \"\"))\n  )) |> \n  filter(world_bank_14 < 10000 & world_bank_14 > 4900) |> \n  arrange(desc(world_bank_14))\n\nurl_gdp <-\n  \"https://en.wikipedia.org/wiki/List_of_countries_by_GDP_(nominal)\"\n\nurl_gdp_bow <- polite::bow(url_gdp)\nurl_gdp_bow\n\ngdp_html <-\n  polite::scrape(url_gdp_bow) |>  # <1>\n  rvest::html_nodes(\"table.wikitable\") |> # <2>\n  rvest::html_table(fill = TRUE) \n\ngdp_tab <- \n  gdp_html[[1]] |> \n  janitor::clean_names() |> \n  slice(-1) |> \n  dplyr::mutate(across(\n    c(imf_1_13,\n      world_bank_14,\n      united_nations_15),\n    ~ as.numeric(str_replace_all(.x, \"[$,]\", \"\"))\n  )) |> \n  filter(world_bank_14 < 10000 & world_bank_14 > 4000) |> \n  arrange(desc(world_bank_14))\n\ncountries <- unique(gdp_tab$country_territory)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n<polite session> https://en.wikipedia.org/wiki/List_of_countries_by_GDP_(nominal)\n    User-agent: polite R package\n    robots.txt: 456 rules are defined for 33 bots\n   Crawl delay: 5 sec\n  The path is scrapable for this user-agent\n<polite session> https://en.wikipedia.org/wiki/List_of_countries_by_GDP_(nominal)\n    User-agent: polite R package\n    robots.txt: 456 rules are defined for 33 bots\n   Crawl delay: 5 sec\n  The path is scrapable for this user-agent\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(rnaturalearth)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nSupport for Spatial objects (`sp`) will be deprecated in {rnaturalearth} and will be removed in a future release of the package. Please use `sf` objects with {rnaturalearth}. For example: `ne_download(returnclass = 'sf')`\n```\n\n\n:::\n\n```{.r .cell-code}\nfiji <- \n  ne_countries(scale = 10, returnclass = \"sf\", country = \"Fiji\") \n\np_Fiji <-\n  ggplot(fiji) +\n  geom_sf(fill = \"#823549\",\n          color = \"black\") +\n  coord_sf(\n    crs = 3460, # https://epsg.io/3460\n    ) +\n  theme_void() +\n  labs(title = gdp_tab |> filter(country_territory == \"Fiji\") |> pull(country_territory),\n       subtitle = scales::dollar(gdp_tab |> filter(country_territory == \"Fiji\") |> pull(world_bank_14), scale=1e6)) +\n    theme(\n      plot.subtitle = element_text(size = 12,\n                                   margin = margin(5.5, 0, 8.5, 0, unit = \"pt\"), \n                                   family = \"lato\",\n                                   hjust = 0.5),\n      plot.title = element_text(hjust = 0.5,\n                                margin = margin(8.5, 0, 5.5, 0, unit = \"pt\"), ),\n      title = element_text(size = 16,\n                           family = \"abril-fatface\",\n                           margin = margin(8.5, 0, 5.5, 0, unit = \"pt\"), )\n    )\n\ncountries <- c(\"Kosovo\", \"Somalia\", \"Togo\", \"Bermuda\", \"Montenegro\", \"Barbados\", \"Eswatini\")\n\ncolors <- c(\"#b9d2b5\", \"#f4cb8d\", \"#d1b2d2\", \"#CFCAC6\", \"#C8AE95\", \"#b5e9f6\", \"#F9B2D0\")\n  \ncountry_plots <- function(country, fill){\n  country_data <-\n    ne_countries(scale = 10, returnclass = \"sf\", country = country)\n\n  p <- ggplot(country_data) +\n    geom_sf(fill = fill,\n            color = \"black\") +\n    coord_sf() +\n    theme_void() +\n    labs(\n      title = gdp_tab |> filter(country_territory == country) |> pull(country_territory),\n      subtitle = scales::dollar(\n        gdp_tab |> filter(country_territory == country) |> pull(world_bank_14),\n        scale = 1e6\n      )\n    ) +\n    theme(\n      plot.subtitle = element_text(size = 12,\n                                   lineheight = 6.5,\n                                   family = \"lato\",\n                                   margin = margin(5.5, 0, 8.5, 0, unit = \"pt\"), \n                                   hjust = 0.5),\n      plot.title = element_text(hjust = 0.5,\n                                lineheight = 6.5,\n                                margin = margin(8.5, 0, 5.5, 0, unit = \"pt\")),\n      title = element_text(size = 16,\n                           margin = margin(8.5, 0, 5.5, 0, unit = \"pt\"), \n                           family = \"abril-fatface\")\n    )\n  \nplot_name <- paste(\"p_\", country, sep = \"\")\n  assign(plot_name, p, envir = .GlobalEnv)\n\n}\n\npurrr::map2(.f = country_plots, .x = countries, .y = colors)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[[1]]\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](taylor-vs-countries-gdp_files/figure-html/unnamed-chunk-3-1.png){width=672}\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n[[2]]\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](taylor-vs-countries-gdp_files/figure-html/unnamed-chunk-3-2.png){width=672}\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n[[3]]\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](taylor-vs-countries-gdp_files/figure-html/unnamed-chunk-3-3.png){width=672}\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n[[4]]\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](taylor-vs-countries-gdp_files/figure-html/unnamed-chunk-3-4.png){width=672}\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n[[5]]\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](taylor-vs-countries-gdp_files/figure-html/unnamed-chunk-3-5.png){width=672}\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n[[6]]\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](taylor-vs-countries-gdp_files/figure-html/unnamed-chunk-3-6.png){width=672}\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n[[7]]\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](taylor-vs-countries-gdp_files/figure-html/unnamed-chunk-3-7.png){width=672}\n:::\n\n```{.r .cell-code}\n# One specifically for Taylor Swift\n\np_blank <-\n  ggplot() +\n  labs(title = \"Taylor Swift\",\n       subtitle = \"$6.3B\") +\n  theme_void() +\n  theme(\n    plot.subtitle = element_text(margin = margin(5.5, 0, 5.5, 0, unit = \"pt\"), \n                                 size = 12,\n                                 family = \"lato\",\n                                 hjust = 0.5),\n    plot.title = element_text(hjust = 0.5,\n                              margin = margin(8.5, 0, 5.5, 0, unit = \"pt\")),\n    title = element_text(lineheight = 0.5,\n                         margin = margin(8.5, 0, 5.5, 0, unit = \"pt\"), \n                         size = 24,\n                         family = \"abril-fatface\",\n                         hjust = 1,\n                         color = \"#823549\"))\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ngdp_plot <-\n  plot_grid(p_Kosovo, p_Somalia, p_Togo, p_Bermuda, p_blank, p_Montenegro, p_Barbados, p_Fiji, p_Eswatini, align = \"v\" ) + \n  draw_image(\n    here::here(\"notebooks\", \"t_swift.png\"),\n    x = 0.4,\n    y = 0.35,\n    width = 0.2,\n    height = 0.2\n  )\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning in grid.Call(C_stringMetric, as.graphicsAnnot(x$label)): font family\n'abril-fatface' not found in PostScript font database\n\nWarning in grid.Call(C_stringMetric, as.graphicsAnnot(x$label)): font family\n'abril-fatface' not found in PostScript font database\n\nWarning in grid.Call(C_stringMetric, as.graphicsAnnot(x$label)): font family\n'abril-fatface' not found in PostScript font database\n\nWarning in grid.Call(C_stringMetric, as.graphicsAnnot(x$label)): font family\n'abril-fatface' not found in PostScript font database\n\nWarning in grid.Call(C_stringMetric, as.graphicsAnnot(x$label)): font family\n'abril-fatface' not found in PostScript font database\n\nWarning in grid.Call(C_stringMetric, as.graphicsAnnot(x$label)): font family\n'abril-fatface' not found in PostScript font database\n\nWarning in grid.Call(C_stringMetric, as.graphicsAnnot(x$label)): font family\n'abril-fatface' not found in PostScript font database\n\nWarning in grid.Call(C_stringMetric, as.graphicsAnnot(x$label)): font family\n'abril-fatface' not found in PostScript font database\n\nWarning in grid.Call(C_stringMetric, as.graphicsAnnot(x$label)): font family\n'abril-fatface' not found in PostScript font database\n\nWarning in grid.Call(C_stringMetric, as.graphicsAnnot(x$label)): font family\n'abril-fatface' not found in PostScript font database\n\nWarning in grid.Call(C_stringMetric, as.graphicsAnnot(x$label)): font family\n'abril-fatface' not found in PostScript font database\n\nWarning in grid.Call(C_stringMetric, as.graphicsAnnot(x$label)): font family\n'abril-fatface' not found in PostScript font database\n\nWarning in grid.Call(C_stringMetric, as.graphicsAnnot(x$label)): font family\n'abril-fatface' not found in PostScript font database\n\nWarning in grid.Call(C_stringMetric, as.graphicsAnnot(x$label)): font family\n'abril-fatface' not found in PostScript font database\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning in grid.Call(C_stringMetric, as.graphicsAnnot(x$label)): font family\n'lato' not found in PostScript font database\n\nWarning in grid.Call(C_stringMetric, as.graphicsAnnot(x$label)): font family\n'lato' not found in PostScript font database\n\nWarning in grid.Call(C_stringMetric, as.graphicsAnnot(x$label)): font family\n'lato' not found in PostScript font database\n\nWarning in grid.Call(C_stringMetric, as.graphicsAnnot(x$label)): font family\n'lato' not found in PostScript font database\n\nWarning in grid.Call(C_stringMetric, as.graphicsAnnot(x$label)): font family\n'lato' not found in PostScript font database\n\nWarning in grid.Call(C_stringMetric, as.graphicsAnnot(x$label)): font family\n'lato' not found in PostScript font database\n\nWarning in grid.Call(C_stringMetric, as.graphicsAnnot(x$label)): font family\n'lato' not found in PostScript font database\n\nWarning in grid.Call(C_stringMetric, as.graphicsAnnot(x$label)): font family\n'lato' not found in PostScript font database\n\nWarning in grid.Call(C_stringMetric, as.graphicsAnnot(x$label)): font family\n'lato' not found in PostScript font database\n\nWarning in grid.Call(C_stringMetric, as.graphicsAnnot(x$label)): font family\n'lato' not found in PostScript font database\n\nWarning in grid.Call(C_stringMetric, as.graphicsAnnot(x$label)): font family\n'lato' not found in PostScript font database\n\nWarning in grid.Call(C_stringMetric, as.graphicsAnnot(x$label)): font family\n'lato' not found in PostScript font database\n\nWarning in grid.Call(C_stringMetric, as.graphicsAnnot(x$label)): font family\n'lato' not found in PostScript font database\n\nWarning in grid.Call(C_stringMetric, as.graphicsAnnot(x$label)): font family\n'lato' not found in PostScript font database\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning in grid.Call(C_stringMetric, as.graphicsAnnot(x$label)): font family\n'abril-fatface' not found in PostScript font database\n\nWarning in grid.Call(C_stringMetric, as.graphicsAnnot(x$label)): font family\n'abril-fatface' not found in PostScript font database\n\nWarning in grid.Call(C_stringMetric, as.graphicsAnnot(x$label)): font family\n'abril-fatface' not found in PostScript font database\n\nWarning in grid.Call(C_stringMetric, as.graphicsAnnot(x$label)): font family\n'abril-fatface' not found in PostScript font database\n\nWarning in grid.Call(C_stringMetric, as.graphicsAnnot(x$label)): font family\n'abril-fatface' not found in PostScript font database\n\nWarning in grid.Call(C_stringMetric, as.graphicsAnnot(x$label)): font family\n'abril-fatface' not found in PostScript font database\n\nWarning in grid.Call(C_stringMetric, as.graphicsAnnot(x$label)): font family\n'abril-fatface' not found in PostScript font database\n\nWarning in grid.Call(C_stringMetric, as.graphicsAnnot(x$label)): font family\n'abril-fatface' not found in PostScript font database\n\nWarning in grid.Call(C_stringMetric, as.graphicsAnnot(x$label)): font family\n'abril-fatface' not found in PostScript font database\n\nWarning in grid.Call(C_stringMetric, as.graphicsAnnot(x$label)): font family\n'abril-fatface' not found in PostScript font database\n\nWarning in grid.Call(C_stringMetric, as.graphicsAnnot(x$label)): font family\n'abril-fatface' not found in PostScript font database\n\nWarning in grid.Call(C_stringMetric, as.graphicsAnnot(x$label)): font family\n'abril-fatface' not found in PostScript font database\n\nWarning in grid.Call(C_stringMetric, as.graphicsAnnot(x$label)): font family\n'abril-fatface' not found in PostScript font database\n\nWarning in grid.Call(C_stringMetric, as.graphicsAnnot(x$label)): font family\n'abril-fatface' not found in PostScript font database\n```\n\n\n:::\n\n```{.r .cell-code}\nsave(gdp_plot, file = here::here(\"images\", \"gdp_plot.rdata\"))\n```\n:::\n",
    "supporting": [
      "taylor-vs-countries-gdp_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}