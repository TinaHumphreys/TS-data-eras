{
  "hash": "a64cb17408d3af16289ca1f177a42fd3",
  "result": {
    "markdown": "::: {.cell}\n\n```{.r .cell-code}\n# To clean data\nlibrary(tidyverse)\nlibrary(janitor)\n\n# To scrape data\nlibrary(rvest)\nlibrary(httr)\nlibrary(polite)\n\n# To visualize data\nlibrary(ggplot2)\nlibrary(showtext)\nlibrary(cowplot)\n\nfont_add_google(\"Abril Fatface\", \"abril-fatface\")\nfont_add_google(\"Lato\", \"lato\")\n\nshowtext::showtext_auto()\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nurl <-\n  \"https://en.wikipedia.org/wiki/List_of_countries_by_GDP_(nominal)\"\n\nurl_bow <- polite::bow(url)\nurl_bow\n\nind_html <-\n  polite::scrape(url_bow) |>  # <1>\n  rvest::html_nodes(\"table.wikitable\") |> # <2>\n  rvest::html_table(fill = TRUE) \n\nind_tab <- \n  ind_html[[1]] |> \n  janitor::clean_names() |> \n  slice(-1) |> \n  dplyr::mutate(across(\n    c(imf_1_13,\n      world_bank_14,\n      united_nations_15),\n    ~ as.numeric(str_replace_all(.x, \"[$,]\", \"\"))\n  )) |> \n  filter(world_bank_14 < 10000 & world_bank_14 > 4900) |> \n  arrange(desc(world_bank_14))\nurl <-\n  \"https://en.wikipedia.org/wiki/List_of_countries_by_GDP_(nominal)\"\n\nurl_bow <- polite::bow(url)\nurl_bow\n\nind_html <-\n  polite::scrape(url_bow) |>  # <1>\n  rvest::html_nodes(\"table.wikitable\") |> # <2>\n  rvest::html_table(fill = TRUE) \n\nind_tab <- \n  ind_html[[1]] |> \n  janitor::clean_names() |> \n  slice(-1) |> \n  dplyr::mutate(across(\n    c(imf_1_13,\n      world_bank_14,\n      united_nations_15),\n    ~ as.numeric(str_replace_all(.x, \"[$,]\", \"\"))\n  )) |> \n  filter(world_bank_14 < 10000 & world_bank_14 > 4000) |> \n  arrange(desc(world_bank_14))\n\ncountries <- unique(ind_tab$country_territory)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(rnaturalearth)\n\nfiji <- \n  ne_countries(scale = 10, returnclass = \"sf\", country = \"Fiji\") \n\np_Fiji <-\n  ggplot(fiji) +\n  geom_sf(fill = \"#823549\",\n          color = \"black\") +\n  coord_sf(\n    crs = 3460, # https://epsg.io/3460\n    ) +\n  theme_void() +\n  labs(title = ind_tab |> filter(country_territory == \"Fiji\") |> pull(country_territory),\n       subtitle = scales::dollar(ind_tab |> filter(country_territory == \"Fiji\") |> pull(world_bank_14), scale=1e6)) +\n    theme(\n      plot.subtitle = element_text(size = 12,\n                                   family = \"lato\"),\n      title = element_text(size = 16,\n                           family = \"abril-fatface\")\n    )\n\ncountries <- c(\"Kosovo\", \"Somalia\", \"Togo\", \"Bermuda\", \"Montenegro\", \"Barbados\", \"Eswatini\")\n\ncolors <- c(\"#b9d2b5\", \"#f4cb8d\", \"#d1b2d2\", \"#b5e9f6\", \"#F9B2D0\", \"#CFCAC6\", \"#C8AE95\")\n  \ncountry_plots <- function(country, fill){\n  country_data <-\n    ne_countries(scale = 10, returnclass = \"sf\", country = country)\n\n  p <- ggplot(country_data) +\n    geom_sf(fill = fill,\n            color = \"black\") +\n    coord_sf() +\n    theme_void() +\n    labs(\n      title = ind_tab |> filter(country_territory == country) |> pull(country_territory),\n      subtitle = scales::dollar(\n        ind_tab |> filter(country_territory == country) |> pull(world_bank_14),\n        scale = 1e6\n      )\n    ) +\n    theme(\n      plot.subtitle = element_text(size = 12,\n                                   family = \"lato\"),\n      title = element_text(size = 16,\n                           family = \"abril-fatface\")\n    )\n  \nplot_name <- paste(\"p_\", country, sep = \"\")\n  assign(plot_name, p, envir = .GlobalEnv)\n\n}\n\npurrr::map2(.f = country_plots, .x = countries, .y = colors)\n\np_blank <-\n  ggplot() +\n  labs(title = \"Taylor Swift\",\n       subtitle = \"$6,300,000,000\") +\n  theme_void() +\n  theme(\n    plot.subtitle = element_text(size = 12,\n                                 family = \"lato\",\n                                 hjust = 0.5),\n    plot.title = element_text(hjust = 0.5),\n    title = element_text(size = 16,\n                         family = \"abril-fatface\",\n                         hjust = 0.5))\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ngdp_plot <-\n  plot_grid(p_Kosovo, p_Somalia, p_Togo, p_Bermuda, p_blank, p_Montenegro, p_Barbados, p_Fiji, p_Eswatini, align = \"h\" ) + \n  draw_image(\n    here::here(\"notebooks\", \"t_swift.jpg\"),\n    x = 0.42,\n    y = 0.36,\n    width = 0.2,\n    height = 0.2\n  )\n\nsave(gdp_plot, file = here::here(\"images\", \"gdp_plot.rdata\"))\n```\n:::\n",
    "supporting": [
      "taylor-vs-countries-gdp_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}