---
title: "Taylor Swift's Tour in the Pantheon of Music"
format: html
title-block-banner: images/hero.png
---

# Taylor Swift's Tour in the Pantheon of Music

## Introduction

Lorem ipsum dolor sit amet, consectetur adipiscing elit. Phasellus eget sem in leo pharetra rhoncus in a felis. Etiam ligula elit, euismod in gravida in, fermentum sed ligula. Aliquam sit amet ipsum ut nisl gravida molestie. Morbi orci tortor, dapibus a dictum vitae, congue sit amet lorem. Praesent purus risus, auctor ac neque sed, interdum feugiat erat. Fusce gravida pellentesque lacus, eget sodales elit sodales vitae. Nunc porttitor pulvinar bibendum.

## The Eras Tour

Lorem ipsum dolor sit amet, consectetur adipiscing elit. Phasellus eget sem in leo pharetra rhoncus in a felis. Etiam ligula elit, euismod in gravida in, fermentum sed ligula. Aliquam sit amet ipsum ut nisl gravida molestie. Morbi orci tortor, dapibus a dictum vitae, congue sit amet lorem. Praesent purus risus, auctor ac neque sed, interdum feugiat erat. Fusce gravida pellentesque lacus, eget sodales elit sodales vitae. Nunc porttitor pulvinar bibendum. 

### Setting the stage

Lorem ipsum dolor sit amet, consectetur adipiscing elit. Phasellus eget sem in leo pharetra rhoncus in a felis. Etiam ligula elit, euismod in gravida in, fermentum sed ligula. 

### Attendance

Lorem ipsum dolor sit amet, consectetur adipiscing elit. Phasellus eget sem in leo pharetra rhoncus in a felis. Etiam ligula elit, euismod in gravida in, fermentum sed ligula. 

#### How many people attended the Eras tour

Lorem ipsum dolor sit amet, consectetur adipiscing elit. Phasellus eget sem in leo pharetra rhoncus in a felis. Etiam ligula elit, euismod in gravida in, fermentum sed ligula.

#### How many cities and states did Taylor Swift hold a concert in

::: {.content-visible when-profile="r"}

{{< include viz/eras-tour-dates-and-venues.qmd >}}

:::

:::{.column-page}

```{r}
#| echo: false
leaflet() %>%
  addProviderTiles("Stadia.StamenWatercolor",
                   group = "Stadia.StamenWatercolor") %>%
  addMarkers(
    data = ind_html_geo,
    label = paste(
      "Venue: ",
      ind_html_geo$venue,
      "<br>",
      "City: ",
      ind_html_geo$city,
      "<br>",
      "Date: ",
      ind_html_geo$date
    ) %>%
      lapply(htmltools::HTML)
  )
```

:::

#### Eras tour compared to her previous tours

Lorem ipsum dolor sit amet, consectetur adipiscing elit. Phasellus eget sem in leo pharetra rhoncus in a felis. Etiam ligula elit, euismod in gravida in, fermentum sed ligula.

### Revenue

Lorem ipsum dolor sit amet, consectetur adipiscing elit. Phasellus eget sem in leo pharetra rhoncus in a felis. Etiam ligula elit, euismod in gravida in, fermentum sed ligula.

#### Annual highest-grossing tours

Lorem ipsum dolor sit amet, consectetur adipiscing elit. Phasellus eget sem in leo pharetra rhoncus in a felis. Etiam ligula elit, euismod in gravida in, fermentum sed ligula.

::: {.content-visible when-profile="r"}

{{< include viz/highest-grossing-tours-r.qmd >}}

:::

`r knitr::include_graphics("images/highest-grossing-tours-r-1.png")`

#### Number of shows vs. income

```{r}
annual_hi_gross_tours <-
  ind_html[[9]] %>%
  clean_names()
```

```{r}
annual_hi_gross_tours_clean <-
  annual_hi_gross_tours %>%
  dplyr::mutate(across(
    c(adjusted_gross_in_2022_dollar,
      actual_gross),
    ~ as.numeric(str_replace_all(.x, "[$,]", ""))
  ),
  year = lubridate::ymd(year, truncated = 2L),
  decade = as.factor(floor_date(year, years(10))))
```

```{r}
annual_hi_gross_tours_clean %>%
  ggplot(aes(
    x = year,
    y = adjusted_gross_in_2022_dollar,
    size =  shows,
    fill = decade
  )) +
  geom_point(alpha = 0.5,
             shape = 21,
             color = "black") +
  scale_size(range = c(.1, 8)) +
  scale_fill_viridis(discrete = TRUE, guide = FALSE, option = "A") +
  theme_minimal() +
  theme(legend.position = "none") +
  labs(title = "Annual highest-grossing tours")
```

# Highest-grossing tours by decade

```{r}
combine_data <- function(ind_html_list) {
  # Initialize an empty tibble
  combined_data <- tibble()
  
  # Loop through the ind_html_list and append each element to the combined_data
  for (i in 4:8) {
    extracted_data <- ind_html_list[[i]] %>% clean_names()
    combined_data <- bind_rows(combined_data, extracted_data)
  }
  
  return(combined_data)
}

annual_hi_gross_tours <- combine_data(ind_html)
```

```{r}
tours_by_decade <-
  annual_hi_gross_tours %>%
  dplyr::mutate(across(
    c(adjusted_gross_in_2022_dollar,
      averagegross,
      actual_gross),
    ~ as.numeric(str_replace_all(.x, "[$,]", ""))
  )) %>%
     add_row(artist = "Taylor Swift",
          tour_title = "The Eras Tour (Expected)",
          year_s = "2023-2024",
          shows = 146,
          adjusted_gross_in_2022_dollar = 1400000000) %>% 
  mutate(
    start_year = str_sub(year_s, start = 1, end = 4),
    year = lubridate::ymd(start_year, truncated = 2L)) %>% 
  mutate(decade = as.factor(floor_date(year, years(10))))
```

```{r}
g1 <- subset(tours_by_decade, tour_title == "The Eras Tour (Expected)")

tours_by_decade %>%
  ggplot(aes(
    x = year,
    y = adjusted_gross_in_2022_dollar,
    size =  shows,
    fill = decade
  )) +
  geom_point(alpha = 0.5,
             shape = 21,
             color = "black") +
  scale_size(range = c(.1, 8)) +
  scale_fill_viridis(discrete = TRUE,
                     guide = FALSE,
                     option = "G") +
  theme_minimal() +
  geom_point(data = g1, colour = "#122B2B") +
  geom_text(
    data = g1,
    label = "Taylor Swift",
    vjust = 2.4,
    size = 3
  ) +
  theme(legend.position = "none") +
  labs(title = "Highest-grossing tours by decade") +
  scale_x_date(limits = c(ymd("1980-01-01"), ymd("2028-01-01")))
```

```{r}
tours_by_decade %>% 
  ggplot(aes(x = shows, y = adjusted_gross_in_2022_dollar)) +
  geom_point()
```

```{r}
tours_by_decade %>% 
  ggplot(aes(x = shows, y = adjusted_gross_in_2022_dollar)) +
  geom_point()
```


```{r}
#| message: false
url2 <- "https://en.wikipedia.org/wiki/List_of_most-attended_concert_tours"
url_bow2 <- polite::bow(url2)
url_bow2

ind_html2 <-
  polite::scrape(url_bow2) %>%  # scrape web page
  rvest::html_nodes("table.wikitable") %>% # pull out specific table
  rvest::html_table(fill = TRUE) 

ind_tab2 <- 
  ind_html2[[2]] %>% 
  clean_names() %>% 
  mutate(tickets_sold = as.numeric(str_replace(tickets_sold, " million.*", "")) * 1e6)

tours_by_decade2 <-
  tours_by_decade %>%
  mutate(
    tour_title = case_when(
      tour_title == "Music of the Spheres World Tour †" ~ "Music of the Spheres World Tour",
      tour_title == "The Garth Brooks World Tour" ~ "The Garth Brooks World Tour (1996–1998)",
      tour_title == "Steel Wheels Tour" ~ "Steel Wheels/Urban Jungle Tour",
      .default = tour_title
    )
  )

cost_per <-
  left_join(ind_tab2, tours_by_decade2, join_by(tour_title))

cost_per %>% 
  mutate(cost_per = adjusted_gross_in_2022_dollar / tickets_sold) %>% 
  ggplot(aes(x = year, y = cost_per)) +
  geom_point()
```



## Locations of Taylor Swift Tours

