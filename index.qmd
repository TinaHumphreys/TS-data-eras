---
title: "Taylor Swift's Tour in the Pantheon of Music"
format: html
title-block-banner: images/hero.png
---

```{r}
#| include: false
#| message: false
#| label: source-files
library(leaflet)
library(bslib)
library(bsicons)
library(shiny)
source(knitr::purl("notebooks/highest-grossing-tours-r.qmd"))
map_html_geo <- read_rds("data/map_html_geo.Rds")
```

## Introduction

Lorem ipsum dolor sit amet, consectetur adipiscing elit. Phasellus eget sem in leo pharetra rhoncus in a felis. Etiam ligula elit, euismod in gravida in, fermentum sed ligula. Aliquam sit amet ipsum ut nisl gravida molestie. Morbi orci tortor, dapibus a dictum vitae, congue sit amet lorem. Praesent purus risus, auctor ac neque sed, interdum feugiat erat. Fusce gravida pellentesque lacus, eget sodales elit sodales vitae. Nunc porttitor pulvinar bibendum.

::: {style="font-family: Abril Fatface"}
## The Eras Tour
:::

Lorem ipsum dolor sit amet, consectetur adipiscing elit. Phasellus eget sem in leo pharetra rhoncus in a felis. Etiam ligula elit, euismod in gravida in, fermentum sed ligula. Aliquam sit amet ipsum ut nisl gravida molestie. Morbi orci tortor, dapibus a dictum vitae, congue sit amet lorem. Praesent purus risus, auctor ac neque sed, interdum feugiat erat. Fusce gravida pellentesque lacus, eget sodales elit sodales vitae. Nunc porttitor pulvinar bibendum. 

{{< video https://www.youtube.com/embed/KudedLV0tP0?si=lGitLqDuHeJ6W_Hi >}}

::: {style="font-family: Abril Fatface"}
### Setting the stage
:::

```{r}
#| echo: false
value_box(
  title = "Number of shows",
  value = "146",
  showcase = bs_icon("calendar-event"),
  theme = "#b9d2b5"
)
```

Lorem ipsum dolor sit amet, consectetur adipiscing elit. Phasellus eget sem in leo pharetra rhoncus in a felis. Etiam ligula elit, euismod in gravida in, fermentum sed ligula. 

```{r}
#| echo: false
value_box(
  title = "Number of cities",
  value = "10,512,000",
    showcase = bs_icon("building"),
    theme = "#f4cb8d",
  p("based on 72k average attendance per show", bs_icon("music-note"))
)
```

Lorem ipsum dolor sit amet, consectetur adipiscing elit. Phasellus eget sem in leo pharetra rhoncus in a felis. Etiam ligula elit, euismod in gravida in, fermentum sed ligula.

```{r}
#| echo: false
value_box(
  title = "Estimated total attendance",
  value = "10,512,000",
  showcase = bs_icon("airplane"),
  theme = "#823549",
  p("based on 72k average attendance per show", bs_icon("music-note")))
```

Lorem ipsum dolor sit amet, consectetur adipiscing elit. Phasellus eget sem in leo pharetra rhoncus in a felis. Etiam ligula elit, euismod in gravida in, fermentum sed ligula. 

::: {style="font-family: Abril Fatface"}
### Attendance
:::

Lorem ipsum dolor sit amet, consectetur adipiscing elit. Phasellus eget sem in leo pharetra rhoncus in a felis. Etiam ligula elit, euismod in gravida in, fermentum sed ligula.

::: {style="font-family: Abril Fatface"}
#### How many people have attended the Eras tour?
:::

Lorem ipsum dolor sit amet, consectetur adipiscing elit. Phasellus eget sem in leo pharetra rhoncus in a felis. Etiam ligula elit, euismod in gravida in, fermentum sed ligula.

::: {style="font-family: Abril Fatface"}
#### How many cities and states has Taylor Swift held a concert in?
:::

Lorem ipsum dolor sit amet, consectetur adipiscing elit. Phasellus eget sem in leo pharetra rhoncus in a felis. Etiam ligula elit, euismod in gravida in, fermentum sed ligula.

::: {.column-page}

```{r}
#| echo: false
#| message: false
pal <- colorFactor(
  palette = c("#823549", "#1D1F38"),
  domain = map_html_geo$occurred
)

leaflet(options = leafletOptions(zoomControl = FALSE,
                                 maxZoom = 12)) |>
  addProviderTiles("Esri.WorldGrayCanvas",
                   options = tileOptions(maxZoom = 12)) |>
  setMaxBounds(
    lng1 = -90,
    lat1 = -180,
    lng2 = 90,
    lat2 = 180
  ) |> 
  addCircleMarkers(
    data = map_html_geo,
    color = ~pal(occurred),
    label = paste(
      "Venue: ",
      map_html_geo$venue,
      "<br>",
      "City: ",
      map_html_geo$city,
      "<br>",
      "Number of Shows: ",
      map_html_geo$number_shows
    ) |>
      lapply(htmltools::HTML)
  ) |> 
  addLegend("bottomright", pal = pal, values = map_html_geo$occurred,
    title = "Event Status",
    opacity = 1
  )
```

:::

::: {style="font-family: Abril Fatface"}
#### Eras tour compared to her previous tours
:::

Lorem ipsum dolor sit amet, consectetur adipiscing elit. Phasellus eget sem in leo pharetra rhoncus in a felis. Etiam ligula elit, euismod in gravida in, fermentum sed ligula.

```{r}
#| echo: false
#| label: taylor-performances-treemap
#| fig-align: center
load(here::here("images", "taylor_treemap.rdata"))
taylor_treemap
```

::: {style="font-family: Abril Fatface"}
### Revenue
:::

Lorem ipsum dolor sit amet, consectetur adipiscing elit. Phasellus eget sem in leo pharetra rhoncus in a felis. Etiam ligula elit, euismod in gravida in, fermentum sed ligula.

```{r}
#| echo: false
#| label: gdp-comparison-plot
#| fig-align: center
load(here::here("images", "gdp_plot.rdata"))
gdp_plot
```

::: {style="font-family: Abril Fatface"}
#### Highest-grossing tours
:::

Lorem ipsum dolor sit amet, consectetur adipiscing elit. Phasellus eget sem in leo pharetra rhoncus in a felis. Etiam ligula elit, euismod in gravida in, fermentum sed ligula.

`r knitr::include_graphics("images/tswift-v-other-sankey-bump.png")`

Lorem ipsum dolor sit amet, consectetur adipiscing elit. Phasellus eget sem in leo pharetra rhoncus in a felis. Etiam ligula elit, euismod in gravida in, fermentum sed ligula.

`r knitr::include_graphics("images/highest-grossing-tour-decade.png")`

:::{style="font-family: Abril Fatface"}
# Taylor's Music
:::

Lorem ipsum dolor sit amet, consectetur adipiscing elit. Phasellus eget sem in leo pharetra rhoncus in a felis. Etiam ligula elit, euismod in gravida in, fermentum sed ligula.

:::: {.columns}

::: {.column width="50%"}

Lorem ipsum dolor sit amet, consectetur adipiscing elit. Phasellus eget sem in leo pharetra rhoncus in a felis. Etiam ligula elit, euismod in gravida in, fermentum sed ligula.

:::

::: {.column width="50%"}

{{< include notebooks/taylor-music.qmd >}}

:::

:::

## Openers

{{< include notebooks/opener-data.qmd >}}