<details><summary>See R code</summary>

::: {.callout-tip}

```{r}
#| include: false
source(here::here("highest-grossing-tours-r.R"))

annual_hi_gross_tours <-
  ind_html[[9]] |>
  clean_names()
```

```{r}
combine_data <- function(ind_html_list) {
  # Initialize an empty tibble
  combined_data <- tibble()
  
  # Loop through the ind_html_list and append each element to the combined_data
  for (i in 4:8) {
    extracted_data <- ind_html_list[[i]] |> clean_names()
    combined_data <- bind_rows(combined_data, extracted_data)
  }
  
  return(combined_data)
}

annual_hi_gross_tours <- combine_data(ind_html)
```

```{r}
tours_by_decade <-
  annual_hi_gross_tours |>
  dplyr::mutate(across(
    c(adjusted_gross_in_2022_dollar,
      averagegross,
      actual_gross),
    ~ as.numeric(str_replace_all(.x, "[$,]", ""))
  )) |>
     add_row(artist = "Taylor Swift",
          tour_title = "The Eras Tour (Expected)",
          year_s = "2023-2024",
          shows = 146,
          adjusted_gross_in_2022_dollar = 1400000000) |> 
  mutate(
    start_year = str_sub(year_s, start = 1, end = 4),
    year = lubridate::ymd(start_year, truncated = 2L)) |> 
  mutate(decade = as.factor(floor_date(year, years(10))))
```

```{r}
g1 <- subset(tours_by_decade, tour_title == "The Eras Tour (Expected)")

tours_by_decade |>
  ggplot(aes(
    x = year,
    y = adjusted_gross_in_2022_dollar,
    size =  shows,
    fill = decade
  )) +
  geom_point(alpha = 0.5,
             shape = 21,
             color = "black") +
  scale_size(range = c(.1, 8)) +
  scale_fill_viridis(discrete = TRUE,
                     guide = FALSE,
                     option = "G") +
  theme_minimal() +
  geom_point(data = g1, colour = "#122B2B") +
  geom_text(
    data = g1,
    label = "Taylor Swift",
    vjust = 2.4,
    size = 3
  ) +
  theme(legend.position = "none") +
  labs(title = "Highest-grossing tours by decade") +
  scale_x_date(limits = c(ymd("1980-01-01"), ymd("2028-01-01")))
```

```{r}
tours_by_decade |> 
  ggplot(aes(x = shows, y = adjusted_gross_in_2022_dollar)) +
  geom_point()
```

```{r}
tours_by_decade |> 
  ggplot(aes(x = shows, y = adjusted_gross_in_2022_dollar)) +
  geom_point()
```






:::
</summary>