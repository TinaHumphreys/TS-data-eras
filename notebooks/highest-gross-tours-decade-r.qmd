<details><summary>See R code</summary>

::: {.callout-tip}

```{r}
#| include: false
source(here::here("highest-grossing-tours-r.R"))

font_add_google("Abril Fatface", "abril-fatface")
font_add_google("Lato", "lato")

showtext::showtext_auto()

annual_hi_gross_tours <- 
  ind_html[[9]] |>
  clean_names()
```

```{r}
combine_data <- function(ind_html_list) {
  # Initialize an empty tibble
  combined_data <- tibble()
  
  # Loop through the ind_html_list and append each element to the combined_data
  for (i in 4:8) {
    extracted_data <- ind_html_list[[i]] |> clean_names()
    combined_data <- bind_rows(combined_data, extracted_data)
  }
  
  return(combined_data)
}

annual_hi_gross_tours <- combine_data(ind_html)
```

```{r}
tours_by_decade <-
  annual_hi_gross_tours |>
  dplyr::mutate(across(
    c(adjusted_gross_in_2022_dollar,
      averagegross,
      actual_gross),
    ~ as.numeric(str_replace_all(.x, "[$,]", "")))) |>
  mutate(start_year = str_sub(year_s, start = 1, end = 4),
         year = lubridate::ymd(start_year, truncated = 2L)) |> 
  mutate(decade = paste0(str_sub(as.factor(floor_date(year, years(10))), start = 1, end = 4), "s"),
         `Adjusted Gross in 2022 Dollars` = -adjusted_gross_in_2022_dollar,
         `Average Gross` = averagegross) |> 
  pivot_longer(cols = c(`Adjusted Gross in 2022 Dollars`, `Average Gross`)) |> 
  select(name, tour_title, value, decade, year)
```

```{r}
ggplot(tours_by_decade) +
  geom_col(aes(value, fct_reorder(tour_title, year, .desc = TRUE), fill = abs(value))) +
  geom_text(
    data = . %>% filter(name == "Adjusted Gross in 2022 Dollars"),
    aes(800000000, tour_title, label = tour_title),
    hjust = 0.5,
    family = "lato",
    size = 3.5
  ) +
  facet_grid2(
    rows = vars(decade),
    cols = vars(toupper(name)),
    scales = "free",
    space = "free_y",
    strip = strip_split(
      c("top", "top"),
      text_x = elem_list_text(color = c("#903345", "grey60")),
      by_layer_x = TRUE
    )
  ) +
  labs(title = "Top 10 highest-grossing tours by decade",
       caption = "Source: Wikipedia Â· Graphic: Inspired by Georgios Karamanis") +
  theme_minimal() +
  coord_cartesian(clip = "off") +
  theme(
    legend.position = "none",
    plot.background = element_rect(fill = "grey99", color = NA),
    axis.text.y = element_blank(),
    axis.title = element_blank(),
    panel.grid.major.y = element_blank(),
    strip.text = element_text(size = 12, face = "bold"),
    plot.title = element_text(face = "bold", size = 16),
    plot.margin = margin(10, 10, 10, 10),
    title = element_text(size = 16,
                             family = "abril-fatface"),
    text = element_text(size = 9,
                            family = "lato")
  )
```

:::
</summary>