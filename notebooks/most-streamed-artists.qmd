```{r}
#| message: false
#| warning: false
# To clean data
library(tidyverse)
library(janitor)

# To scrape data
library(rvest)
library(httr)
library(polite)
```

```{r}
streams_url <-
  "https://en.wikipedia.org/wiki/List_of_most-streamed_artists_on_Spotify"

streams_url_bow <- polite::bow(streams_url)

ind_html <-
  polite::scrape(streams_url_bow) |>  # <1>
  rvest::html_nodes("table.wikitable") |> # <2>
  rvest::html_table(fill = TRUE)
```
1. Scrape the webpage
2. Pull out anything that is a `wikitable` 

```{r}
top_listeners_tab <- 
  ind_html[[4]] |> 
  clean_names()

most_followed_tab <- 
  ind_html[[5]] |> 
  clean_names()

spotify_data <-
  left_join(top_listeners_tab, most_followed_tab, join_by(artist == artist_68)) |> 
  rename(monthly_listeners_millions_rank = rank.x,
         followers_millions_rank = rank.y)
```


